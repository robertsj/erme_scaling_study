#===============================================================================
# To make, ensure SLEPC_DIR and PETSC_ARCH are correctly specified.
#===============================================================================

program = scaling

#===============================================================================
# PETSc/SLEPc files
#===============================================================================

include ${SLEPC_DIR}/conf/slepc_common

#===============================================================================
# Object Files
#===============================================================================

objects =             \
driver.o              \
data.o                \
connect.o             \
test.o                

#===============================================================================
# User Options
#===============================================================================

COMPILER = mpic++
OPTIMIZE = yes
PETSC_ARCH = gcc-acml-release
SLEPC_ARCH = gcc-acml-release

#==============================================================================
# Set Options
#==============================================================================

F90FLAGS = -I${PETSC_DIR}/include -I${SLEPC_DIR}/include
LDFLAGS = ${SLEPC_LIB}


ifeq ($(DEBUG),yes)

  F90FLAGS += -g 
  LDFLAGS += -g

endif

#===============================================================================
# Targets
#===============================================================================

all: $(program)

$(program): $(objects) 
	${COMPILER} $(objects) -o $@ $(LDFLAGS)

clean::
	@rm scaling

#===============================================================================
# Rules
#===============================================================================

.SUFFIXES: .F90 .o
.PHONY: all clean neat

%.o: %.F90
	${COMPILER} $(F90FLAGS) -c $<

#===============================================================================
# Dependencies
#===============================================================================

data.o: connect.o

driver.o: test.o
driver.o: data.o

test.o: data.o
